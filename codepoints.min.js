(function(root){"use strict";var defineProperty=Object.defineProperty;var install=function(o,k,f){if(Object.defaultProperty){Object.defaultProperty(o,k,{value:f,writable:true,configurable:true})}else{if(o[k])return;o[k]=f;if(defineProperty)defineProperty(o,k,{enumerable:false})}};var fromCharCode=String.fromCharCode;var re_uchars=/([\uD800-\uDBFF][\uDC00-\uDFFFF]|[\S\s])/g;install(RegExp,"RE_UCHARS",re_uchars);install(String.prototype,"codePointsOf",function(){return(""+this).replace(re_uchars,"_").length});if(defineProperty){defineProperty(String.prototype,"codepoints",{get:function(){return(""+this).codePointsOf()}})}install(String.prototype,"forEachUChar",function(f,ctx){var i=0,s=""+this;s.replace(re_uchars,function(u){f.call(ctx,u,i++,s)})});install(String.prototype,"toArrayOfUChars",function(){var ret=[];(""+this).replace(re_uchars,function(cp){ret.push(cp)});return ret});install(String.prototype,"uCharAt",function(n){return(""+this).toArrayOfUChars()[n]});install(String,"fromCodePoint",function(n){if(n<0&&n>1114111)throw new RangeError("invalid codepoint");if(n<65535)return fromCharCode(n);var offset=n-65536,hi=(offset>>>10)+55296,lo=(offset&1023)+56320;return fromCharCode(hi)+fromCharCode(lo)});install(String.prototype,"codePointAt",function(n){var c=(""+this).toArrayOfUChars()[n];if(!c)return NaN;if(c.length===1)return c.charCodeAt(0);return 65536+(c.charCodeAt(0)-55296)*1024+(c.charCodeAt(1)-56320)})})(this);